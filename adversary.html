<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" />

    <link rel="shortcut icon" href="_static/A.png"/><!-- Generated with Sphinx 6.2.1 and Furo 2023.05.20 -->
        <title>Autonomous Adversary Profiles - Arsenal latest documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?digest=e6660623a769aa55fea372102b9bf3151b292993" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">Arsenal latest documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon no-toc" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="_static/A.png" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">Arsenal latest documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  
</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon no-toc" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="autonomous-adversary-profiles">
<h1>Autonomous Adversary Profiles<a class="headerlink" href="#autonomous-adversary-profiles" title="Permalink to this heading">#</a></h1>
<p>This plugin focuses on using <strong>both</strong> traditional cybersecurity TTPs with AI/ML specific TTPs to Red-Team a system that is AI-enabled. It is our collected understanding that AI/ML algorithms and artifacts are rarely stand-alone, and adversaries in-the-wild will use traditional cybersecurity tactics and techniques alongside AI/ML tactics and techniques in order to achieve their goals. For more examples of these attacks on real-workd systems, please navigate to the <a class="reference external" href="https://atlas.mitre.org/studies"><code class="docutils literal notranslate"><span class="pre">MITRE</span> <span class="pre">ATLAS</span> <span class="pre">Case</span> <span class="pre">Studies</span></code></a> page.</p>
<p>All <code class="docutils literal notranslate"><span class="pre">arsenal</span></code> adversaries use a combination of TTPs from MITRE ATT&amp;CK (plugin: <a class="reference external" href="https://github.com/mitre/stockpile"><code class="docutils literal notranslate"><span class="pre">stockpile</span></code></a>) and MITRE ATLAS (plugin: arsenal).</p>
<p>Below is a description and example of the current autonomous adversary profiles currently implemented:</p>
</section>
<section id="tensormancer">
<h1>Tensormancer<a class="headerlink" href="#tensormancer" title="Permalink to this heading">#</a></h1>
<p>An adversary profile to demo neural network abilities using the Tensorflow library.</p>
<p><em>Abilities</em>:</p>
<ol class="arabic simple">
<li><p><a class="reference external" href="https://github.com/mitre/stockpile/blob/master/data/abilities/collection/6469befa-748a-4b9c-a96d-f191fde47d89.yml"><code class="docutils literal notranslate"><span class="pre">Create</span> <span class="pre">a</span> <span class="pre">staging</span> <span class="pre">directory</span></code></a> for exfiltration.</p></li>
<li><p>Discover GPUs present</p></li>
<li><p>Find Tensorflow model checkpoint files with the extension: <code class="docutils literal notranslate"><span class="pre">.ckpt</span></code></p></li>
<li><p>Search and Stage Tensorflow model files</p>
<ul class="simple">
<li><p>Searches for Tensorflow directories and checkpoint files, and then stages for exfiltration.</p></li>
</ul>
</li>
<li><p>Install Python</p>
<ul class="simple">
<li><p>Download and install Python and it’s dependencies (<code class="docutils literal notranslate"><span class="pre">Python</span> <span class="pre">3.7+</span></code>) where the agent is deployed.</p></li>
</ul>
</li>
<li><p>Determine Python3 version</p>
<ul class="simple">
<li><p>Determine Python3 is installed and version (<code class="docutils literal notranslate"><span class="pre">Python</span> <span class="pre">3.7+</span></code>) where the agent is deployed.</p></li>
</ul>
</li>
<li><p>PIP Install Tensorflow-GPU</p>
<ul class="simple">
<li><p>Use pip to install Tensorflow-GPU</p></li>
</ul>
</li>
<li><p>PIP Install Tensorflow-CPU</p>
<ul class="simple">
<li><p>Use pip to install Tensorflow-CPU</p></li>
</ul>
</li>
<li><p>CNN Image Classifier</p>
<ul class="simple">
<li><p>Searches for images and applies an image classifier</p></li>
</ul>
</li>
<li><p><a class="reference external" href="https://github.com/mitre/stockpile/blob/master/data/abilities/exfiltration/300157e5-f4ad-4569-b533-9d1fa0e74d74.yml"><code class="docutils literal notranslate"><span class="pre">Compress</span> <span class="pre">staged</span> <span class="pre">directory</span></code></a></p>
<ul class="simple">
<li><p>Compress a directory on the file system</p></li>
</ul>
</li>
<li><p><a class="reference external" href="https://github.com/mitre/stockpile/blob/master/data/abilities/exfiltration/ea713bc4-63f0-491c-9a6f-0b01d560b87e.yml"><code class="docutils literal notranslate"><span class="pre">Exfil</span> <span class="pre">staged</span> <span class="pre">directory</span></code></a></p>
<ul class="simple">
<li><p>exfiltrate over the C2 channel</p></li>
</ul>
</li>
</ol>
</section>
<section id="ml-model-thief">
<h1>ML Model Thief<a class="headerlink" href="#ml-model-thief" title="Permalink to this heading">#</a></h1>
<p>An adversary profile to find any hosted ML algorithms with file extensions matching: <code class="docutils literal notranslate"><span class="pre">.mar</span></code>, <code class="docutils literal notranslate"><span class="pre">.pth</span></code>, <code class="docutils literal notranslate"><span class="pre">.pt</span></code>, <code class="docutils literal notranslate"><span class="pre">.onnx</span></code>, <code class="docutils literal notranslate"><span class="pre">.pkl</span></code>, <code class="docutils literal notranslate"><span class="pre">.tflite</span></code>, <code class="docutils literal notranslate"><span class="pre">.pb</span></code>, <code class="docutils literal notranslate"><span class="pre">.hdf5</span></code> and exfiltrate the algorithm back to the C2 server.</p>
<ol class="arabic simple">
<li><p><a class="reference external" href="https://github.com/mitre/stockpile/blob/master/data/abilities/collection/90c2efaa-8205-480d-8bb6-61d90dbaf81b.yml"><code class="docutils literal notranslate"><span class="pre">Find</span> <span class="pre">Files</span></code></a></p></li>
<li><p><a class="reference external" href="https://github.com/mitre/stockpile/blob/master/data/abilities/collection/6469befa-748a-4b9c-a96d-f191fde47d89.yml"><code class="docutils literal notranslate"><span class="pre">Create</span> <span class="pre">staging</span> <span class="pre">directory</span></code></a></p></li>
<li><p><a class="reference external" href="https://github.com/mitre/stockpile/blob/master/data/abilities/collection/4e97e699-93d7-4040-b5a3-2e906a58199e.yml"><code class="docutils literal notranslate"><span class="pre">Stage</span> <span class="pre">sensitive</span> <span class="pre">files</span></code></a></p></li>
<li><p><a class="reference external" href="https://github.com/mitre/stockpile/blob/master/data/abilities/exfiltration/300157e5-f4ad-4569-b533-9d1fa0e74d74.yml"><code class="docutils literal notranslate"><span class="pre">Compress</span> <span class="pre">staged</span> <span class="pre">directory</span></code></a></p></li>
<li><p><a class="reference external" href="https://github.com/mitre/stockpile/blob/master/data/abilities/exfiltration/ea713bc4-63f0-491c-9a6f-0b01d560b87e.yml"><code class="docutils literal notranslate"><span class="pre">Exfil</span> <span class="pre">staged</span> <span class="pre">directory</span></code></a></p>
<ul class="simple">
<li><p>exfiltrate over the C2 channel</p></li>
</ul>
</li>
</ol>
</section>
<section id="ml-model-evader">
<h1>ML Model Evader<a class="headerlink" href="#ml-model-evader" title="Permalink to this heading">#</a></h1>
<p>An adversary profile to evade correction classification or detection of a machine learning algorithm using the Microsoft Counterfit library. It is recommended to use the <a class="reference external" href="https://github.com/mitre-atlas/ml-vulhub/tree/main/envs/example-00-ml-dev"><code class="docutils literal notranslate"><span class="pre">ML-Vulhub</span> <span class="pre">Example-00</span></code></a> or the <a class="reference external" href="https://github.com/mitre-atlas/ml-vulhub/tree/main/envs/example-01-ml-dev"><code class="docutils literal notranslate"><span class="pre">ML-Vulhub</span> <span class="pre">Example-01</span></code></a> example environments in conjuction with this adversary profile. The set-up of this example vulnerable environment is detailed in <a class="reference external" href="https://github.com/mitre-atlas/caldera-atlas"><code class="docutils literal notranslate"><span class="pre">caldera-atlas</span></code></a>.</p>
<p><em>Abilities</em>:</p>
<ol class="arabic">
<li><p>Find or Install Microsoft Counterfit package</p>
<ul class="simple">
<li><p>This package is installed as a python-venv within the C2 server at installation via <a class="reference external" href="https://github.com/mitre-atlas/caldera-atlas"><code class="docutils literal notranslate"><span class="pre">caldera-atlas</span></code></a>, this ability checks for the virtual environment and packages installed, and if not found will install the necessary dependencies. This is esspecially useful for installation on a victim system for processing externally to the C2 server.</p></li>
</ul>
</li>
<li><p>Gather Information for Protocol Addresses</p>
<ul class="simple">
<li><p>Gathers the IP address and netmask (in CIDR notation) for each IP address
available on system where the agent is deployed. Only IPs with “scope global” (valid everywhere) are considered.</p></li>
</ul>
</li>
<li><p>Gather Information for TCP sockets</p>
<ul class="simple">
<li><p>Show TCP connections (-t) in listening (-l) state, without resolving the IP addresses and the port number (-n).</p></li>
</ul>
</li>
<li><p>Gather Information for Remote Services</p>
<ul class="simple">
<li><p>Gathers information on the status (“Up”, “Down”, etc.) of other hosts on the network where the agent is deployed by executing a “ping scan”. Then, a “port scan” is executed on “Up” hosts to gather information for remote services.</p></li>
</ul>
</li>
<li><p>Discover Torchserve API</p>
<ul class="simple">
<li><p>This ability specifically looks for any Torshserve API endpoints that may be hosting models. If found, it will create Facts with the API endpoint and algorithm for future API access. Torchserve has two API endpoints, an Inference API and a Management API, both are needed information for gaining information about hosted algorithms and sending data for inference. A single API may host multiple algorithms.</p></li>
</ul>
</li>
<li><p>ML Model Inference API Access</p>
<ul class="simple">
<li><p>This ability maps the algorithms hosted via the Torchserve Management API to the prediction endpoint for the Torchserve Inference API.</p></li>
</ul>
</li>
<li><p>Build and Attack a Custom CFTarget (Counterfit Target)</p>
<ul>
<li><p>This ability creates Counterfit Targets from any and all found algorithms and API endpoints. From these targets, users can choose which endpoints and data (images) they would like to use to generate Adversarial Attacks using the Counterfit library. Current imagery attacks that are autonomously generated are the black-box optimizers: hop-skip-jump, boundary, and copycat-cnn.</p></li>
<li><p><strong>If you are using the <a class="reference external" href="https://github.com/mitre-atlas/ml-vulhub/tree/main/envs/example-01-ml-dev"><code class="docutils literal notranslate"><span class="pre">ML-Vulhub</span> <span class="pre">Example-01</span></code></a> example environment, you will need to <strong>manuall</strong> add this ability to select which found model you would like to craft adversarial data for. You can run this ability multiple times, selecting new models for each new Link Command, as shown here:</strong></p>
<p><img alt="ml_attack_staging" src="_images/ml_attack_staging_new_potential_link.png" /></p>
<p>An example output of Adding this potential Link Command is:</p>
<p><img alt="ml_attack_staging_2" src="_images/ml_attack_staging_example_output.png" /></p>
</li>
</ul>
</li>
</ol>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          
          
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2023, ATLAS
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer no-toc">
      
      
      
    </aside>
  </div>
</div><script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/scripts/furo.js"></script>
    </body>
</html>